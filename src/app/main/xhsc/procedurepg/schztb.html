<div style="position: absolute;right: 8px">
    <md-button class="md-fab md-mini" ng-click="vm.goBack()">
        <md-icon md-svg-src="app/main/xhsc/images/icon-comeback.svg"></md-icon>
    </md-button>
</div>

<div flex layout="column">
    <form method="post" action="http://emp.chngalaxy.com:9091/api/MaterialPlan/GetMaterialReportXls" target="_blank">
        <input id="export" type="hidden" name="table" />
        <input id="tital" type="hidden" name="tital" value="实测实量报表" />
        <md-button class="md-raised md-primary" type="submit" ng-click="vm.printBatchCount()">Excel导出</md-button>
    </form>
    <md-content id="divReport" class="subheader" style="position:relative;" flex layout-padding>
        <div style="font-size: 14px;">文字说明：<span style="padding-right:10px;">总包</span><span class="jlfont" style="padding-right:10px;">监理</span><span style="padding-right:10px;" class="xmfont">项目部</span></div>
        <table width="100%" cellpadding="0" cellspacing="0" class="levelTable">
            <thead>
                <tr style="border: 1px solid #ddd;">
                    <th colspan="24" style="text-align: center;" class="head">
                        {{vm.info.pname}}
                    </th>
                </tr>
                <tr style="border: 1px solid #ddd;" ng-repeat="item in vm.checkUser">
                    <th colspan="10" rowspan="{{vm.checkUser.length}}" ng-if="$index == 0">
                        项目名称：{{vm.info.name}}
                    </th>
                    <th colspan="5">检查人：{{item.UserName}}</th>
                    <th colspan="9">检查日期：{{item.MeasureTime}}</th>
                </tr>
                <tr style="border: 1px solid #ddd;">
                    <th style="width:60px;text-align: center;">指标</th>
                    <th style="text-align: center;white-space: nowrap;">结果</th>
                    <th style="text-align: center;white-space: nowrap;">合格率</th>
                    <th ng-repeat="i in vm.twentyRows">{{$index+1}}</th>
                </tr>
            </thead>
            <tbody ng-repeat="item in vm.scData" class="parentH">
                <tr style="border: 1px solid #ddd;" ng-repeat="row in item.rows" ng-if="!item.Children">
                    <td rowspan="{{item.rows.length}}" ng-if="$index == 0" style="padding: 0;">
                        <table width="100%" cellpadding="0" cellspacing="0" class="levelTable leveltable2">
                            <tr>
                                <td style="white-space: nowrap;"><a ui-sref="app.xhsc.scsl.schztbdetail({regionId:vm.regionId,itemId:item.AcceptanceIndexID,acceptanceItemID:vm.AcceptanceItemID,MeasureRecordID:item.MeasureRecordID})">{{item.IndexName}}</a></td>
                            </tr>
                        </table>
                    </td>
                    <td rowspan="{{item.rows.length}}" ng-if="$index == 0" align="center">
                        <span ng-repeat="n in item.numbers" ng-class="{'jlfont':n.Role == 2,'xmfont':n.Role == 4}">{{n.allDot}}</span>
                    </td>
                    <td rowspan="{{item.rows.length}}" ng-if="$index == 0">
                        <span ng-repeat="n in item.QualifiedRate" ng-class="{'jlfont':n.Role == 2,'xmfont':n.Role == 4}">{{n.Value|number:2}}%</span>
                    </td>
                    <td ng-repeat="point in row" style="padding:0 6px;">
                        <span ng-repeat="v in point.MeasureValue|orderBy:'Role'" ng-class="{'yellow':v.Status == 2,'red':v.Status == 3,'jlfont':v.Role == 2,'xmfont':v.Role == 4}">{{v.Value}}</span>
                    </td>
                </tr>
                <!--<tr ng-repeat="row in item.pointArr" ng-if="!item.Children">-->
                <!--<td rowspan="{{item.rows.length}}" ng-if="$index == 0" style="padding: 0;">-->
                <!--<table width="100%" cellpadding="0" cellspacing="0" class="levelTable leveltable2">-->
                <!--<tr>-->
                <!--<td style="white-space: nowrap;"><a ui-sref="app.xhsc.scsl.schztbdetail({regionId:vm.regionId,itemId:item.AcceptanceIndexID,acceptanceItemID:vm.AcceptanceItemID})">{{item.IndexName}}</a></td>-->
                <!--</tr>-->
                <!--</table>-->
                <!--</td>-->
                <!--<td rowspan="{{item.rows.length}}" ng-if="$index == 0" align="center">-->
                <!--<span ng-repeat="n in item.numbers" ng-class="{'jlfont':n.Role == 2,'xmfont':n.Role == 4}">{{n.allDot}}</span>-->
                <!--</td>-->
                <!--<td rowspan="{{item.rows.length}}" ng-if="$index == 0">-->
                <!--<span ng-repeat="n in item.QualifiedRate" ng-class="{'jlfont':n.Role == 2,'xmfont':n.Role == 4}">{{n.Value|number:2}}%</span>-->
                <!--</td>-->
                <!--<td ng-repeat="point in row" style="padding:0 6px;">-->
                <!--<span ng-repeat="v in point.MeasureValue|orderBy:'Role'" ng-class="{'yellow':v.Status == 2,'red':v.Status == 3,'jlfont':v.Role == 2,'xmfont':v.Role == 4}">{{v.Value}}</span>-->
                <!--</td>-->
                <!--</tr>-->
                <tr style="border: 1px solid #ddd;" ng-repeat="row in item.Children" ng-if="item.Children">
                    <td rowspan="{{item.Children.length}}" ng-if="$index == 0" style="padding: 0;">
                        <table width="100%" cellpadding="0" cellspacing="0" class="levelTable leveltable2" table-auto-height>
                            <tr ng-repeat="row in item.Children">
                                <td rowspan="{{item.Children.length}}" ng-if="$index == 0">{{item.IndexName}}</td>
                                <td><a ui-sref="app.xhsc.scsl.schztbdetail({regionId:vm.regionId,itemId:row.AcceptanceIndexID,acceptanceItemID:vm.AcceptanceItemID,MeasureRecordID:item.MeasureRecordID})">{{row.IndexName}}</a></td>
                            </tr>
                        </table>
                    </td>
                    <td align="center" rowspan="{{item.rowSpan}}" ng-if="$index==0" style="padding: 0;">
                        <span ng-class="{'jlfont':n.Role == 2,'xmfont':n.Role == 4}" ng-repeat="n in item.allDot|orderBy:'Role'">{{n.Value}}</span>
                    </td>
                    <td rowspan="{{item.rowSpan}}" ng-if="$index==0" style="padding:0;">
                        <span ng-class="{'jlfont':n.Role == 2,'xmfont':n.Role == 4}" ng-repeat="n in item.Qual|orderBy:'Role'">{{n.Value*100|number:2}}%</span>
                    </td>
                    <td ng-repeat="point in row.rows[0]">
                        <span ng-class="{'yellow':v.Status == 2,'red':v.Status == 3,'jlfont':v.Role == 2,'xmfont':v.Role == 4}" ng-repeat="v in point.MeasureValue" ng-bind-html="v.Value"></span>
                    </td>
                    <!--<td ng-repeat="point in row">{{point.MeasureValue}}</td>-->
                </tr>
            </tbody>
        </table>
    </md-content>
</div>